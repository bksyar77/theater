<Window x:Class="Theater.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Theater"
        Title="Theater Scheduler" Height="640" Width="1100"
        WindowStartupLocation="CenterScreen"
        MinWidth="900" MinHeight="520">




    <DockPanel>

        <!-- Menu -->
        <Menu DockPanel.Dock="Top" IsMainMenu="True">
            <MenuItem Header="Save" Command="{Binding SaveDataCommand}" Click="SaveData_Click" />
            <MenuItem Header="Load" Command="{Binding LoadDataCommand}" Click="LoadData_Click"/>
            <MenuItem Header="Export Excel" Command="{Binding ExportExcelCommand}" />
            <MenuItem Header="Export Word" Command="{Binding ExportWordCommand}" />
            <MenuItem Header="Exit" Command="{x:Static ApplicationCommands.Close}" />
        </Menu>

        <!-- Toolbar -->


        <!-- Main content -->
        <Grid Margin="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*" />
                <ColumnDefinition Width="2*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>



            <!-- Actors panel -->
            <GroupBox Header="Актёры" Grid.Row="1" Grid.Column="0" Margin="4">
                <DockPanel>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,6">
                        <Button Content="Добавить" Command="{Binding AddActorCommand}" Width="90" Margin="0,0,6,0" Click="AddActorTable"/>
                        <Button Content="Экспорт статистики (Word)"
Margin="10,0,0,0"
Width="200"
Click="ExportGlobalStats_Click"/>

                    </StackPanel>

                    <DataGrid x:Name="ActorsDataGrid"
          ItemsSource="{Binding Actors}"
          AutoGenerateColumns="False"
          CanUserAddRows="False"
          SelectionMode="Single"
          IsReadOnly="False"
          SelectionChanged="ActorsDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Имя" Binding="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Width="*" />
                            <DataGridTextColumn Header="Роль" Binding="{Binding Role, UpdateSourceTrigger=PropertyChanged}" Width="150" />
                            <DataGridTextColumn Header="Часы" Binding="{Binding Balance, StringFormat=N2}" Width="110" />
                            <DataGridTextColumn Header="Участий" Binding="{Binding Participations.Count}" IsReadOnly="True" Width="80" />
                        </DataGrid.Columns>

                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Редактировать актёра..." Click="EditActorContextMenu_Click"/>
                                <MenuItem Header="Удалить актёра" Click="DeleteActorContextMenu_Click"/>
                                <MenuItem Header="Статистика актёра..." Click="ActorStatsContextMenu_Click"/>
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                    </DataGrid>
                </DockPanel>
            </GroupBox>

            <!-- Events panel -->
            <GroupBox Header="События" Grid.Row="1" Grid.Column="1" Margin="4">
                <DockPanel>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,6">
                        <Button Content="Добавить" Width="90" Margin="0,0,6,0" Click="AddEventTable"/>
                        <Button Content="Удалить" Width="90" Margin="0,0,6,0"/>
                        <CheckBox Content="Фильтр по актёру"
                                  Margin="10,0,0,0"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterByActor}"/>
                    </StackPanel>

                    <DataGrid x:Name="EventsDataGrid"
                  ItemsSource="{Binding EventsView}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  SelectionMode="Single"
                  IsReadOnly="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Название" Binding="{Binding Title, UpdateSourceTrigger=PropertyChanged}" Width="*" />
                            <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=yyyy-MM-dd HH:mm}" Width="150" />
                            <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="120" />
                        </DataGrid.Columns>

                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Открыть редактирование..." Click="EditEventContextMenu_Click"/>
                                <MenuItem Header="Удалить событие" Click="DeleteEventContextMenu_Click"/>
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                    </DataGrid>
                </DockPanel>
            </GroupBox>

        </Grid>
    </DockPanel>
</Window>